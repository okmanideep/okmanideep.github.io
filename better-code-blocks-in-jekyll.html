<!DOCTYPE html>
<html>
<head>
    <!-- [[! Document Settings ]] -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- [[! Page Meta ]] -->
    <title>Better code blocks in Jekyll</title>
    <meta name="description" content="@okmanideep - Android 路 Development 路 Design" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" type="image/svg+xml" href="/assets/favicon-6e776a280d622eaae06cf84bba86ccae938052110ad2a9cdf38eff5ccee8b296.svg" >
    <link rel="shortcut icon" type="image/png" href="/assets/favicon-9d237f287925749d655560da077779bcddb8bc07cd0b419ae0844f7d9de94f7b.png" >

    <!-- [[! Styles'n'Scripts ]] -->
    <link type="text/css" rel="stylesheet" href="/assets/main-7c194601e209e1be55c0eb1b34c6f79616c03831fdb3afd1c3817fad4c20ff2c.css">
    <link href='https://fonts.googleapis.com/css?family=Inconsolata' rel='stylesheet' type='text/css'>

    <!-- [[! Ghost outputs important style and meta data with this tag ]] -->
        <link rel="canonical" href="" />
    <meta name="referrer" content="origin" />
    <link rel="next" href="page2/" />

    <meta property="og:site_name" content="@okmanideep" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Better code blocks in Jekyll" />
    <meta property="og:description" content="Your code can look a lot better in your blog powered by Jekyll if you do these simple things. Add line numbers, line highlights in your plain github flavored markdown in all your blog posts." />
    <meta property="og:url" content="https://okmanideep.github.io/better-code-blocks-in-jekyll" />
    <meta property="og:image" content="https://okmanideep.github.io/assets/logo-black-on-white-square-20105d9e3b41defc83bbf981802e512e19a10853e8eeb5976222f9311ca6f8b8.jpg" />
    <meta property="og:locale" content="en_US" />
    <meta property="article:author" content="https://www.facebook.com/manideepiitb">

    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Better code blocks in Jekyll" />
    <meta name="twitter:description" content="Your code can look a lot better in your blog powered by Jekyll if you do these simple things. Add line numbers, line highlights in your plain github flavored markdown in all your blog posts." />
    <meta name="twitter:image" content="https://okmanideep.github.io/assets/logo-black-on-white-square-20105d9e3b41defc83bbf981802e512e19a10853e8eeb5976222f9311ca6f8b8.jpg" />
    <meta name="twitter:author" content="@okmanideep">

    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Website",
    "publisher": "Manideep Polireddi",
    "url": "https://okmanideep.github.io",
    "image": "/assets/logo-black-2e47e992b06507b3775750a2b8b939d6e1eecd27a8a1991865497c7e901ff8b5.png",
    "description": "Android 路 Development 路 Design"
}
    </script>

    <meta name="generator" content="Jekyll 3.0.0" />
    <link rel="alternate" type="application/rss+xml" title="@okmanideep" href="feed.xml" />


</head>
<body class="post-template nav-closed">

    <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        <li class="nav-home " role="presentation"><a href="">Home</a></li>
        <!--<li class="nav-about " role="presentation"><a href="about.html">About</a></li>
        <li class="nav-fables " role="presentation"><a href="tag/fables/">Fables</a></li>
        <li class="nav-speeches " role="presentation"><a href="tag/speeches/">Speeches</a></li>
        <li class="nav-fiction " role="presentation"><a href="tag/fiction/">Fiction</a></li>-->
        <li class="nav-author " role="presentation"><a href="author/okmanideep/">Author</a></li>
    </ul>
    <a class="subscribe-button icon-feed" href="feed.xml">Subscribe</a>
</div>
<span class="nav-cover"></span>


    <div class="site-wrapper">

        <!-- [[! Everything else gets inserted here ]] -->
        <!-- < default -->

<!-- The comment above "< default" means - insert everything in this file into -->
    <!-- the [body] of the default.hbs template, which contains our header/footer. -->

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->

<header class="main-header post-head no-cover">
    <nav class="main-nav  clearfix">
        <a class="blog-logo" href="/"><img src="/assets/logo-white-75ce62a26171e897ee54c33128a1c7e591909134ef170d6c866e9ea84501473c.png" alt="Blog Logo"></a>
        <a class="subscribe-logo" href="feed.xml">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d="M25.57 176.1C12.41 175.4 .9117 185.2 .0523 198.4s9.173 24.65 22.39 25.5c120.1 7.875 225.7 112.7 233.6 233.6C256.9 470.3 267.4 480 279.1 480c.5313 0 1.062-.0313 1.594-.0625c13.22-.8438 23.25-12.28 22.39-25.5C294.6 310.3 169.7 185.4 25.57 176.1zM32 32C14.33 32 0 46.31 0 64s14.33 32 32 32c194.1 0 352 157.9 352 352c0 17.69 14.33 32 32 32s32-14.31 32-32C448 218.6 261.4 32 32 32zM63.1 351.9C28.63 351.9 0 380.6 0 416s28.63 64 63.1 64s64.08-28.62 64.08-64S99.37 351.9 63.1 351.9z"/></svg>
        </a>
    </nav>
</header>

<main class="content" role="main">

    <article class="post tag-jekyll tag-gh-pages">

        <header class="post-header">
            <h1 class="post-title">Better code blocks in Jekyll</h1>
            <section class="post-meta">
            <!-- <a href=''>Manideep Polireddi</a> -->
            <time class="post-date" datetime="2015-11-23">23 Nov 2015</time>
                <!-- [[tags prefix=" on "]] -->
                 
                on 
                
                    
                       <a href='/tag/jekyll'>Jekyll</a>,
                       
                
                    
                       <a href='/tag/gh-pages'>Gh-pages</a>
                       
                
                
            </section>
        </header>

        <section class="post-content">
            <p>If you are blogging a lot of code, it makes a huge difference if you style your code blocks well. If you are using some Jekyll theme, chances are the default output is not so pleasing. If you are not much familiar with <code>Jekyll</code> or <code>Pygments</code>, trust me it would take a lot of time to get what you want by just searching the web. I have gathered  all the scattered suggestions I found and arranged them into this post. Let&#39;s make your code look better</p>

<h2>Setting up pygments</h2>

<p>In <code>_config.yml</code></p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span></span><a id="line-1" name="line-1"></a><span class="ss">markdown</span><span class="p">:</span> <span class="n">redcarpet</span>
<a id="line-2" name="line-2"></a><span class="ss">redcarpet</span><span class="p">:</span>
<a id="line-3" name="line-3"></a>    <span class="ss">extension</span><span class="p">:</span>
<a id="line-4" name="line-4"></a>        <span class="o">-</span> <span class="n">fenced_code_blocks</span>
<a id="line-5" name="line-5"></a><span class="ss">highlighter</span><span class="p">:</span> <span class="n">pygments</span>
<a id="line-6" name="line-6"></a><span class="o">...</span>
<a id="line-7" name="line-7"></a><span class="o">...</span>
</code></pre></div>
<p>This sets <code>redcarpet</code> as our markdown parser and <code>pygments</code> as our code highlighter.<br>
And <code>fenced_code_blocks</code> extension enables you to write code blocks like in Github flavoured markdown using ```  </p>

<figure class="highlight"><pre><code class="language-text" data-lang="text"><span></span><a id="True-1" name="True-1"></a>```css
<a id="True-2" name="True-2"></a>.left {float: left;}
<a id="True-3" name="True-3"></a>
<a id="True-4" name="True-4"></a>.right {float: right;}
<a id="True-5" name="True-5"></a>```</code></pre></figure>

<h2>Syntax highlighting</h2>

<p>By now your code probably looks like this</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text"><span></span>  .left {float: left;}
  
  .right {float: right;}</code></pre></figure>

<p>Just like plain text and no syntax highlighting based on the language you specified. But if you look at source you can see that <code>pygments</code> has analysed the code as css and added some classes to different parts of the code. All we need to do is add some css to those classes.</p>

<p>I have written a <a href="https://gist.github.com/okmanideep/aa0890c6da9104e16a7a">github like color scheme</a>. You can find other styles online for <a href="https://www.google.co.in/search?q=pygments+syntax+highlighting+css">pygments syntax highlighting css</a>.</p>

<p>After adding the sytax highlighting css your code should look like this</p>

<figure class="highlight"><pre><code class="language-css" data-lang="css"><span></span>  <span class="p">.</span><span class="nc">left</span> <span class="p">{</span><span class="k">float</span><span class="p">:</span> <span class="kc">left</span><span class="p">;}</span>
  
  <span class="p">.</span><span class="nc">right</span> <span class="p">{</span><span class="k">float</span><span class="p">:</span> <span class="kc">right</span><span class="p">;}</span></code></pre></figure>

<h2>Line Numbers</h2>

<p>As mentioned by <a href="https://drewsilcock.co.uk/proper-linenumbers/">Drew Silcock</a>, <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Lists_and_Counters/Using_CSS_counters">CSS Counters</a> is the best way to add line numbers to your code blocks. Add css counters to your <code>pre</code> blocks using <a href="https://gist.github.com/okmanideep/55419a959b7fd39a1c89">jekyll-pygments-line-numbers.css</a>.</p>

<p>To use this technique we should tell pygments to generate <code>lineanchors</code> for the code blocks. We can do this by using liquid template tags for our code blocks</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text"><span></span><a id="True-1" name="True-1"></a>{% highlight css %}
<a id="True-2" name="True-2"></a>.left {float: left;}
<a id="True-3" name="True-3"></a>
<a id="True-4" name="True-4"></a>.right {float: right;}
<a id="True-5" name="True-5"></a>{% endhighlight %}</code></pre></figure>

<p>But we want to write our code block using ```<code>css</code>. We can do this by adding a custom redcarpet parser. Add this <code>redcarpet-custom.rb</code> file to your <code>_plugins</code> folder</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span></span><a id="line-1" name="line-1"></a><span class="k">module</span> <span class="nn">Jekyll</span>
<a id="line-2" name="line-2"></a>  <span class="k">module</span> <span class="nn">Converters</span>
<a id="line-3" name="line-3"></a>    <span class="k">class</span> <span class="nc">Markdown</span>
<a id="line-4" name="line-4"></a>      <span class="k">class</span> <span class="nc">RedcarpetParser</span>
<a id="line-5" name="line-5"></a>        <span class="k">module</span> <span class="nn">WithPygments</span>
<a id="line-6" name="line-6"></a>          <span class="kp">include</span> <span class="no">CommonMethods</span>
<a id="line-7" name="line-7"></a>          <span class="k">def</span> <span class="nf">block_code</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">lang</span><span class="p">)</span>
<a id="line-8" name="line-8"></a>            <span class="nb">require</span> <span class="s1">&#39;pygments&#39;</span>
<a id="line-9" name="line-9"></a>            <span class="n">lang</span> <span class="o">=</span> <span class="n">lang</span> <span class="o">&amp;&amp;</span> <span class="n">lang</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">first</span> <span class="o">||</span> <span class="s2">&quot;text&quot;</span>
<a id="line-10" name="line-10"></a>            <span class="n">output</span> <span class="o">=</span> <span class="n">add_code_tags</span><span class="p">(</span>
<a id="line-11" name="line-11"></a>              <span class="no">Pygments</span><span class="o">.</span><span class="n">highlight</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="ss">:lexer</span> <span class="o">=&gt;</span> <span class="n">lang</span><span class="p">,</span>
<a id="line-12" name="line-12"></a>                                 <span class="ss">:options</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">:encoding</span> <span class="o">=&gt;</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="ss">:lineanchors</span> <span class="o">=&gt;</span><span class="s1">&#39;line&#39;</span> <span class="p">}),</span>
<a id="line-13" name="line-13"></a>              <span class="n">lang</span>
<a id="line-14" name="line-14"></a>            <span class="p">)</span>
<a id="line-15" name="line-15"></a>          <span class="k">end</span>
<a id="line-16" name="line-16"></a>        <span class="k">end</span>
<a id="line-17" name="line-17"></a>      <span class="k">end</span>
<a id="line-18" name="line-18"></a>    <span class="k">end</span>
<a id="line-19" name="line-19"></a>  <span class="k">end</span>
<a id="line-20" name="line-20"></a><span class="k">end</span>
</code></pre></div>
<p>You can add as many <a href="http://pygments.org/docs/formatters/">Pygment options</a> to the <code>:options =&gt; { ... }</code> hash. The above ovverrides the <a href="https://github.com/jekyll/jekyll/blob/master/lib/jekyll/converters/markdown/redcarpet_parser.rb">WithPygments module</a> of the redcarpet parser.</p>

<p>After this your code blocks should look like</p>
<div class="highlight"><pre><code class="language-css" data-lang="css"><span></span><a id="line-1" name="line-1"></a><span class="p">.</span><span class="nc">left</span> <span class="p">{</span><span class="k">float</span><span class="p">:</span> <span class="kc">left</span><span class="p">;}</span>
<a id="line-2" name="line-2"></a>
<a id="line-3" name="line-3"></a><span class="p">.</span><span class="nc">right</span> <span class="p">{</span><span class="k">float</span><span class="p">:</span> <span class="kc">right</span><span class="p">;}</span>
</code></pre></div>
<h2>Line highlighting</h2>

<p>...</p>

        </section>

        <hr />
    </article>

</main>

<aside class="read-next">

    <!-- [[! next_post ]] -->
    
        <a class="read-next-story no-cover" href="/clean-way-to-define-support-library-dependencies">
            <section class="post">
                <h2>Clean way to define support library dependencies</h2>
                <time class="post-date" datetime="2015-11-23">24 Nov 2015</time>
            </section>
        </a>
    
    <!-- [[! /next_post ]] -->
    <!-- [[! prev_post ]] -->
    
        <a class="read-next-story prev no-cover" href="/permissions-in-marshmallow">
            <section class="post">
                <h2>Permissions in marshmallow</h2>
                <time class="post-date" datetime="2015-11-14">15 Nov 2015</time>
            </section>
        </a>
    
    <!-- [[! /prev_post ]] -->
</aside>

<!-- /post -->


        <footer class="site-footer clearfix">
          <section class="copyright"><a href="/">@okmanideep</a> &copy; 2022</section>
          <section class="poweredby">Published with <a href="http://jekyllrb.com/">Jekyll</a></section>
        </footer>
    </div>
    <!-- Add Google Analytics  -->
        <!-- Google Analytics Tracking code -->
     <script>
	    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	    ga('create', 'UA-57441445-3', 'auto');
	    ga('send', 'pageview');

     </script>   
</body>
</html>
